<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Redirecting...</title>
  <script>
    async function logAndRedirect() {
      const userAgent = navigator.userAgent;
      const referrer = document.referrer || "Direct";
      const deviceType = /Mobi|Android/i.test(userAgent) ? "Mobile" : "Desktop";
      const browser = (() => {
        if (userAgent.includes("Chrome") && !userAgent.includes("Edg")) return "Chrome";
        if (userAgent.includes("Firefox")) return "Firefox";
        if (userAgent.includes("Safari") && !userAgent.includes("Chrome")) return "Safari";
        if (userAgent.includes("Edg")) return "Edge";
        return "Other";
      })();

      const logData = {
        timestamp: new Date().toISOString(),
        userAgent,
        referrer,
        deviceType,
        browser
      };

      try {
        await fetch("https://script.google.com/macros/s/AKfycbz6NjmdYZ5kJDUQ14lUIxaQabTKMLNAFiOsTBEWfMJEZ3NbfCty9yw4Zx8dttmD1nlA/exec", {  // <-- Replace this
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(logData)
        });
      } catch (err) {
        console.warn("Logging failed:", err);
      }

      // Redirect to the actual petition page
      window.location.href = "https://attivati.legambiente.it/page/138932/petition/1?ea.tracking.id=unibo";
    }

    window.onload = logAndRedirect;
  </script>
</head>
<body>
  <p>Redirecting to the petition...</p>
</body>
</html>
